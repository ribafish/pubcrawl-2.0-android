!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.policiesGui=e()}}(function(){return function e(i,t,n){function o(a,s){if(!t[a]){if(!i[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=t[a]={exports:{}};i[a][0].call(u.exports,function(e){var t=i[a][1][e];return o(t?t:e)},u,u.exports,e,i,t,n)}return t[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,i,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(i,t,n){return t&&e(i.prototype,t),n&&e(i,n),i}}(),a=e("./PoliciesManager"),s=n(a),l=function(){function e(i){var t=this;if(o(this,e),!i)throw Error("Policy Engine is not set!");this.policiesManager=new s["default"](i),this.elements=this._setElements(),$(".settings-btn").on("click",function(e){parent.postMessage({body:{method:"showAdminPage"},to:"runtime:gui-manager"},"*"),$(".admin-page").removeClass("hide"),document.getElementsByTagName("body")[0].style="background-color:white;"}),$(".policies-page-show").on("click",function(e){$(".policies-section").removeClass("hide"),t._goHome()}),$(".admin-page-exit").on("click",function(e){parent.postMessage({body:{method:"hideAdminPage"},to:"runtime:gui-manager"},"*"),$(".admin-page").addClass("hide"),document.getElementsByTagName("body")[0].style="background-color:transparent;"}),$(".group-management-btn").on("click",function(e){$(".groups-management-modal").openModal(),t._manageGroups()}),$(".exit-btn").on("click",function(e){$(".subscription-type").addClass("hide")})}return r(e,[{key:"_addMember",value:function(){var e=this;$(".groups-show").addClass("hide");var i=event.target.closest("tr").id;$(".member-new-intro").html('<h5>Add a member to a group</h5><p>Insert a user email below to add to the "'+i+'" group.</p>'),$(".member-new").removeClass("hide"),$(".member-new-ok").on("click",function(t){var n=$("#member-new").val();e.policiesManager.addToGroup(i,n),e._manageGroups()})}},{key:"_createGroup",value:function(){var e=this;$(".groups-show").addClass("hide"),$("#group-new-name").val(""),$(".group-new").removeClass("hide"),$(".group-new-ok").on("click",function(i){var t=$("#group-new-name").val();e.policiesManager.createGroup(t),e._manageGroups()})}},{key:"_createPolicy",value:function(){var e=this;$("#policy-new-title").val(""),$(".policy-new").openModal(),$(".policy-new-ok").off(),$(".policy-new-ok").on("click",function(i){var t=$("#policy-new-title").val();e.policiesManager.createPolicy(t),$(".policy-new").closeModal(),e._goHome()})}},{key:"_decreaseRulePriority",value:function(){var e=event.target.closest("tr").id,i=e.split(":"),t=parseInt(i[i.length-1]);i.pop();var n=i.join(":"),o=this.policiesManager.getPolicy(n).getLastPriority();if(o!=t){var r=parseInt(t+1);this.policiesManager.decreaseRulePriority(n,t,r),this._goHome()}}},{key:"_deleteMember",value:function(){var e=event.target.closest("tr").id,i=e.split("::"),t=i[i.length-1];i.pop();var n=i.join("::");this.policiesManager.removeFromGroup(n,t),this._manageGroups()}},{key:"_deleteGroup",value:function(){var e=event.target.closest("tr").children[0].id;this.policiesManager.deleteGroup(e),this._manageGroups()}},{key:"_deletePolicy",value:function(){var e=event.target.closest("tr").id;this.policiesManager.deletePolicy(e),this._goHome()}},{key:"_deleteRule",value:function(){var e=event.target.closest("tr").id,i=e.split(":"),t=i[i.length-1];i.pop();var n=i.join(":"),o=this.policiesManager.getRuleOfPolicy(n,t);this.policiesManager.deleteRule(n,o),this._goHome()}},{key:"_getActivePolicy",value:function(){var e=this;$(".policy-active").html("");var i=this.policiesManager.getActivePolicy(),t='<form">',n=this.policiesManager.getPoliciesTitles();for(var o in n)t+=n[o]===i?'<p><input name="policies-list" type="radio" id="'+n[o]+'" checked/><label for="'+n[o]+'" class="policies-list black-text">'+n[o]+"</label></p>":'<p><input name="policies-list" type="radio" id="'+n[o]+'"/><label for="'+n[o]+'" class="policies-list black-text">'+n[o]+"</label></p>";t+="</form>",n.length>0&&$(".policy-active").html("<p><b>Activate a policy:</b></p>"+t),$(".policies-list").on("click",function(i){var t=i.target.textContent;e.policiesManager.updateActivePolicy(t)})}},{key:"_getGroupOptions",value:function(e,i,t,n){var o="<option disabled selected>"+e+"</option>";for(var r in i){o+="<optgroup label="+i[r]+">";for(var a in n[r])o+='<option id="'+t[r]+'">'+n[r][a]+"</option>"}return o}},{key:"_getInfo",value:function(e){var i=void 0;switch(e){case"Date":if(i=$(".config").find("input").val(),i.indexOf(",")!==-1){var t=i.split(" ");t[1]=t[1].substring(0,t[1].length-1);var n=["January","February","March","April","May","June","July","August","September","October","November","December"];i=t[0]+"/"+(n.indexOf(t[1])+1)+"/"+t[2]}else{var o=i.split("-");i=o[2]+"/"+o[1]+"/"+o[0]}break;case"Groups of users":i=$("#group").find(":selected").text();break;case"Subscription preferences":(i=void 0!==$("input[name='rule-new-subscription']:checked")[0])&&(i=$("input[name='rule-new-subscription']:checked")[0].id);break;case"Weekday":i=$("#weekday").find(":selected").text();break;default:i=$(".config").find("input").val()}return i}},{key:"_getList",value:function(e){for(var i="",t=e.length,n=0;n<t;n++)i+='<li class="divider"></li>',i+='<li><a class="center-align">'+e[n]+"</a></li>";return i}},{key:"_getOptions",value:function(e,i,t){var n='<select id="'+e+'" class="browser-default"><option disabled selected>'+i+"</option>";for(var o in t)n+="<option>"+t[o]+"</option>";return n+="</select>"}},{key:"_getPoliciesTable",value:function(){var e=this;$(".policies-current").html("");var i=this.policiesManager.getFormattedPolicies(),t=[],n=[],o=[];for(var r in i)t.push(i[r].title),n.push(i[r].rulesTitles),o.push(i[r].ids);var a="<table>",s=0===t.length;for(var l in t){a+='<thead><tr id="'+t[l]+'"><td></td><td></td><th>'+t[l]+'</th><td><i class="material-icons clickable-cell policy-delete" style="cursor: pointer; vertical-align: middle">delete_forever</i></td></tr></thead><tbody>';for(var c in n[l])a+='<tr id="'+o[l][c]+'" ><td><i class="material-icons clickable-cell rule-priority-increase" style="cursor: pointer; vertical-align: middle">arrow_upward</i></td><td><i class="material-icons clickable-cell rule-priority-decrease" style="cursor: pointer; vertical-align: middle">arrow_downward</i></td><td class="rule-show clickable-cell" style="cursor: pointer">'+n[l][c]+'</td><td><i class="material-icons clickable-cell rule-delete" style="cursor: pointer; vertical-align: middle">clear</i></td></tr>';a+='<tr id="'+t[l]+'"><td></td><td></td><td style="text-align:center"><i class="material-icons clickable-cell rule-add" style="cursor: pointer">add_circle</i></td></tr>'}s?$(".policies-current").append("<p>There are no configurations set.</p>"):(a+="</tbody></table>",$(".policies-current").append(a)),$(".rule-add").on("click",function(i){e._showVariablesTypes()}),$(".rule-delete").on("click",function(i){e._deleteRule()}),$(".rule-show").on("click",function(i){e._showRule()}),$(".rule-priority-increase").on("click",function(i){e._increaseRulePriority()}),$(".rule-priority-decrease").on("click",function(i){e._decreaseRulePriority()}),$(".policy-add").off(),$(".policy-add").on("click",function(i){e._createPolicy()}),$(".policy-delete").on("click",function(i){e._deletePolicy()})}},{key:"_goHome",value:function(){this._getActivePolicy(),this._getPoliciesTable()}},{key:"_increaseRulePriority",value:function(){var e=event.target.closest("tr").id,i=e.split(":"),t=parseInt(i[i.length-1]);if(0!==t){i.pop();var n=i.join(":"),o=t-1;this.policiesManager.increaseRulePriority(n,t,o),this._goHome()}}},{key:"_manageGroups",value:function(){var e=this;$(".groups-current").html(""),$(".group-new").addClass("hide"),$(".member-new").addClass("hide"),$(".groups-show").removeClass("hide");var i=this.policiesManager.getGroups(),t=i.groupsNames,n=i.members,o=i.ids,r="<table>",a=0===t.length;for(var s in t){r+='<thead><tr><th id="'+t[s]+'">'+t[s]+'</th><td style="text-align:right"><i class="material-icons clickable-cell group-delete" style="cursor: pointer; vertical-align: middle">delete_forever</i></td></tr></thead><tbody>';for(var l in n[s])r+='<tr id="'+o[s][l]+'" ><td style="cursor: pointer">'+n[s][l]+'</td><td style="text-align:right"><i class="material-icons clickable-cell member-delete" style="cursor: pointer; vertical-align: middle">clear</i></td></tr>';r+='<tr id="'+t[s]+'"><td><i class="material-icons clickable-cell member-add" style="cursor: pointer">add_circle</i></td></tr>'}a?$(".groups-current").append("<p>There are no groups set.</p>"):(r+="</tbody></table>",$(".groups-current").append(r)),$(".member-add").on("click",function(i){e._addMember()}),$(".member-delete").on("click",function(i){e._deleteMember()}),$(".group-add").on("click",function(i){e._createGroup()}),$(".group-delete").on("click",function(i){e._deleteGroup()})}},{key:"_setElements",value:function(){var e=this;return{date:function(e){return'<input type="date" class="datepicker">'},select:function(i){return e._getOptions(i[0],i[1],i[2])},form:function(e){return'<form><input type="text" placeholder="'+e+'"></input></form>'}}}},{key:"_showNewConfigurationPanel",value:function(e){var i=event.target.text;$(".variable").html(this._getNewConfiguration(e,i)),$(".scopes").empty().html("");var t=["Email","Hyperty","All"],n=["user","hyperty","global"],o=[];o.push(this.policiesManager.getMyEmails()),o.push(this.policiesManager.getMyHyperties()),o.push(["All identities and hyperties"]),$(".scopes").append(this._getGroupOptions("Apply this configuration to:",t,n,o)),$(".variable").removeClass("hide")}},{key:"_showVariablesTypes",value:function(){var e=this,i=event.target.closest("tr").id;$("#variables-types").empty().html("");var t=this.policiesManager.getVariables();$("#variables-types").append(this._getList(t)),$(".variable").addClass("hide"),$(".rule-new").openModal(),$("#variables-types").off(),$("#variables-types").on("click",function(t){e._showNewConfigurationPanel(i)})}},{key:"_getNewConfiguration",value:function(e,i){var t=this,n=this.policiesManager.getVariableInfo(i);if($(".rule-new-title").html(n.title),$(".description").html(n.description),$(".config").html(""),"Subscription preferences"===i)$(".subscription-type").removeClass("hide");else{$(".subscription-type").addClass("hide");var o=n.input;for(var r in o)"Group of users"===i&&o[r][1].push(this.policiesManager.getGroupsNames()),$(".config").append(this.elements[o[r][0]](o[r][1])),"Group of users"===i&&o[r][1].pop();"date"===i&&$(".datepicker").pickadate({selectMonths:!0,selectYears:15})}document.getElementById("allow").checked=!1,document.getElementById("block").checked=!1,$(".ok-btn").off(),$(".ok-btn").on("click",function(n){if(void 0===$("input[name='rule-new-decision']:checked")[0])throw Error("INFORMATION MISSING: please specify an authorisation decision.");var o=t._getInfo(i),r=$("input[name='rule-new-decision']:checked")[0].id;r="allow"===r;var a=$(".scopes").find(":selected")[0].id,s=$(".scopes").find(":selected")[0].textContent;s="All identities and hyperties"===s?"global":s,t.policiesManager.setInfo(i,e,o,r,a,s),$(".rule-new").closeModal(),t._goHome()})}},{key:"_deleteInfo",value:function(e){var i=event.target.closest("tr").id,t=i.split(":"),n=t[0];t.shift();var o=t.join(""),r=event.target.closest("tr").children[0].id;this.policiesManager.deleteInfo(e,n,o,r),this._goHome()}},{key:"_showRule",value:function(){var e=this,i=event.target.textContent,t=event.target.closest("tr").id,n=t.split(":"),o=n[n.length-1];n.pop();var r=n.join(":"),a=this.policiesManager.getRuleOfPolicy(r,o);if("subscription"===a.condition.attribute&&"preauthorised"===a.condition.params)$(".authorise-btns").addClass("hide");else{var s=void 0;s=a.authorise?document.getElementById("btn-allow"):document.getElementById("btn-block"),s.checked=!0,$(".authorise-btns").removeClass("hide")}$(".member-add").addClass("hide"),$(".member-new-btn").addClass("hide"),$(".rule-details").openModal(),$(".rule-title").html("<h5><b>"+i+"</b></h5>"),"subscription"===a.condition.attribute&&$(".subscription-type").removeClass("hide"),$(".subscription-decision").on("click",function(i){e._updateRule("subscription",r,a)}),$(".decision").off(),$(".decision").on("click",function(i){e._updateRule("authorisation",r,a)})}},{key:"_updateRule",value:function(e,i,t){var n=$(".rule-title").text(),o=n.split(" "),r=o.indexOf("is");switch(r===-1&&(r=o.indexOf("are")),e){case"authorisation":var a=$("input[name='rule-update-decision']:checked")[0].id;"btn-allow"===a?(o[r+1]="allowed",a=!0):(o[r+1]="blocked",a=!1),n=o.join(" "),$(".rule-title").html("<h5><b>"+n+"</b></h5>"),this.policiesManager.updatePolicy(i,t,a);break;case"subscription":var s=event.target.labels[0].textContent;o[r+1];o=n.split("hyperties are"),"All subscribers"===s?($(".authorise-btns").removeClass("hide"),a=t.authorise,s="*",n="Subscriptions from all hyperties are"+o[1]):($(".authorise-btns").addClass("hide"),a=!0,s="preauthorised",n="Subscriptions from previously authorised hyperties are"+o[1]),$(".rule-title").html("<h5><b>"+n+"</b></h5>"),this.policiesManager.updatePolicy(i,t,a,s)}this._goHome()}}]),e}();t["default"]=l},{"./PoliciesManager":2}],2:[function(e,i,t){"use strict";function n(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,i){for(var t=0;t<i.length;t++){var n=i[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(i,t,n){return t&&e(i.prototype,t),n&&e(i,n),i}}(),r=function(){function e(i){n(this,e),this.policyEngine=i,this.policies=this.policyEngine.context.policies,this.variables=this.setVariables(),this.addition=this.setAdditionMethods(),this.validation=this.setValidationMethods()}return o(e,[{key:"addToGroup",value:function(e,i){this.policyEngine.addToGroup(e,i)}},{key:"createGroup",value:function(e){this.policyEngine.createGroup(e)}},{key:"createPolicy",value:function(e){this.policyEngine.addPolicy("USER",e)}},{key:"decreaseRulePriority",value:function(e,i,t){this.getRuleOfPolicy(e,t).priority=i,this.getRuleOfPolicy(e,i).priority=t,this.policyEngine.context.savePolicies("USER")}},{key:"deleteGroup",value:function(e){this.policyEngine.deleteGroup(e)}},{key:"deletePolicy",value:function(e){this.policyEngine.removePolicy("USER",e)}},{key:"deleteRule",value:function(e,i){var t=this.policyEngine.context.userPolicies;t[e].deleteRule(i),this.policyEngine.context.savePolicies("USER")}},{key:"getActivePolicy",value:function(){return this.policyEngine.context.activeUserPolicy}},{key:"getPolicy",value:function(e){return this.policyEngine.context.userPolicies[e]}},{key:"getPoliciesTitles",value:function(){var e=this.policyEngine.context.userPolicies,i=[];for(var t in e)i.push(t);return i}},{key:"getTargets",value:function(e){var i=[];for(var t in this.policies[e])i.indexOf(t)===-1&&i.push(t);return i}},{key:"increaseRulePriority",value:function(e,i,t){this.getRuleOfPolicy(e,i).priority=t,this.getRuleOfPolicy(e,t).priority=i,this.policyEngine.context.savePolicies("USER")}},{key:"setVariables",value:function(){return{Date:{title:"<br><h5>Updating date related configurations</h5><p>Incoming communications in the introduced date will be allowed or blocked according to your configurations, which can be changed in the preferences page.</p><br>",description:"<p>Date:</p>",input:[["date",[]]]},Domain:{title:"<br><h5>Updating domain configurations</h5><p>Incoming communications from a user whose identity is from the introduced domain allowed or blocked according to your configurations, which can be changed in the preferences page.</p><br>",description:"<p>Domain:</p>",input:[["form",[]]]},"Group of users":{title:"<br><h5>Updating groups configurations</h5><p>Incoming communications from a user whose identity is in the introduced group will be allowed or blocked according to your configurations, which can be changed in the preferences page.</p><br>",description:"<p>Group name:</p>",input:[["select",["group","Select a group:"]]]},"Subscription preferences":{title:"<br><h5>Updating subscriptions configurations</h5><p>The acceptance of subscriptions to your hyperties will be allowed or blocked according to your configurations, which can be changed in the preferences page.</p><br>",input:[]},"Time of the day":{title:'<br><h5>Updating time configurations</h5><p>Incoming communications in the introduced timeslot will be blocked, but this can be changed in the preferences page.</p><p>Please introduce a new timeslot in the following format:</p><p class="center-align">&lt;START-HOUR&gt;:&lt;START-MINUTES&gt; to &lt;END-HOUR&gt;:&lt;END-MINUTES&gt;</p><br>',description:"<p>Timeslot:</p>",input:[["form",[]]]},Weekday:{title:"<br><h5>Updating weekday configurations</h5><p>Incoming communications in the introduced weekday will be allowed or blocked according to your configurations, which can be changed in the preferences page.</p><br>",description:"<p>Weekday:</p>",input:[["select",["weekday","Select a weekday:",["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"]]]]}}}},{key:"setAdditionMethods",value:function(){var e=this;return{Date:function(i){var t=i[0],n=e.policyEngine.context.userPolicies;n[t].createRule("simple",i[4],["date","equals",i[3]],i[1],i[2]),e.policyEngine.context.savePolicies("USER")},Domain:function(i){var t=i[0],n=e.policyEngine.context.userPolicies;n[t].createRule("simple",i[4],["domain","equals",i[3]],i[1],i[2]),e.policyEngine.context.savePolicies("USER")},"Group of users":function(i){var t=i[0],n=e.policyEngine.context.userPolicies;n[t].createRule("simple",i[4],["source","in",i[3]],i[1],i[2]),e.policyEngine.context.savePolicies("USER")},"Subscription preferences":function(i){var t=i[0],n=e.policyEngine.context.userPolicies,o="equals";"preauthorised"===i[3]&&(o="in"),n[t].createRule("subscription",i[4],["subscription",o,i[3]],i[1],i[2]),e.policyEngine.context.savePolicies("USER")},"Time of the day":function(i){var t=i[0],n=e.policyEngine.context.userPolicies;i[3]=i[3].split(" to ");var o=i[3][0].split(":");o=o.join("");var r=i[3][1].split(":");r=r.join(""),n[t].createRule("simple",i[4],["time","between",[o,r]],i[1],i[2]),e.policyEngine.context.savePolicies("USER")},Weekday:function(i){var t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];i[3]=t.indexOf(i[3]);var n=i[0],o=e.policyEngine.context.userPolicies;o[n].createRule("simple",i[4],["weekday","equals",i[3]],i[1],i[2]),e.policyEngine.context.savePolicies("USER")}}}},{key:"setValidationMethods",value:function(){var e=this;return{Date:function(i,t){return e.isValidDate(t)&e.isValidScope(i)},"Group of users":function(i,t){return e.isValidString(t)&e.isValidScope(i)},Domain:function(i,t){return e.isValidDomain(t)&e.isValidScope(i)},Weekday:function(i,t){return!0&e.isValidScope(i)},"Subscription preferences":function(i,t){return e.isValidSubscriptionType(t)&e.isValidScope(i)},"Time of the day":function(i,t){return e.isValidTimeslot(t)&e.isValidScope(i)}}}},{key:"updateActivePolicy",value:function(e){this.policyEngine.context.activeUserPolicy=e,this.policyEngine.context.saveActivePolicy()}},{key:"isValidEmail",value:function(e){var i=/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$/;return i.test(e)}},{key:"isValidDomain",value:function(e){var i=/[a-z0-9.-]+\.[a-z]{2,3}$/;return i.test(e)}},{key:"isValidString",value:function(e){var i=/[a-z0-9.-]$/;return i.test(e)}},{key:"isValidSubscriptionType",value:function(e){return!0}},{key:"isValidDate",value:function(e){var i=e.split("/"),t=parseInt(i[0]),n=parseInt(i[1]),o=parseInt(i[2]),r=new Date(o,n-1,t),a=r.getFullYear()===o&&r.getMonth()+1===n&&r.getDate()===t,s=(r.getDate()+"/"+(r.getMonth()+1)+"/"+r.getFullYear(),new Date),l=(s.getDate()+"/"+(s.getMonth()+1)+"/"+s.getFullYear(),!1);return r.getFullYear()>s.getFullYear()?l=!0:r.getFullYear()==s.getFullYear()&&(r.getMonth()+1>s.getMonth()+1?l=!0:r.getMonth()+1==s.getMonth()+1&&r.getDate()>=s.getDate()&&(l=!0)),a&&l}},{key:"isValidScope",value:function(e){return""!==e}},{key:"isValidTimeslot",value:function(e){if(!e)return!1;var i=e.split(" to "),t=2===i.length;if(!t)return!1;var n=i[0].split(":"),o=i[1].split(":");if(2!==n.length||2!==o.length)return!1;var r=2===n[0].length&&2===n[1].length&&2===o[0].length&&2===o[1].length,a=n[0]==parseInt(n[0],10)&&n[1]==parseInt(n[1],10)&&o[0]==parseInt(o[0],10)&&o[1]==parseInt(o[1],10);return t&&r&&a}},{key:"getFormattedPolicies",value:function(){var e=this.policyEngine.context.userPolicies,i=[];for(var t in e){var n={title:e[t].key,rulesTitles:[],ids:[]};if(0!==e[t].rules.length){e[t].rules=e[t].sortRules();for(var o in e[t].rules){var r=(e[t].rules[o],this._getTitle(e[t].rules[o]));n.rulesTitles.push(r),n.ids.push(n.title+":"+e[t].rules[o].priority)}}i.push(n)}return i}},{key:"getRuleOfPolicy",value:function(e,i){var t=this.policyEngine.context.userPolicies,n=t[e];return n.getRuleByPriority(i)}},{key:"_getTitle",value:function(e){var i=e.condition,t=e.authorise?"allowed":"blocked",n="global"===e.target?"All identities and hyperties":e.target,o=i.attribute;switch(o){case"date":return"Date "+i.params+" is "+t+" ("+n+")";case"domain":return'Domain "'+i.params+'" is '+t+" ("+n+")";case"source":if("in"===i.operator)return'Group "'+i.params+'" is '+t+" ("+n+")";if("equals"===i.operator)return"User "+i.params+" is "+t+"("+n+")";case"subscription":if("*"===i.params)return"Subscriptions from all hyperties are "+t+" ("+n+")";if("preauthorised"===i.params)return"Subscriptions from previously authorised hyperties are allowed ("+n+")";case"time":var r=i.params[0][0]+i.params[0][1]+":"+i.params[0][2]+i.params[0][3],a=i.params[1][0]+i.params[1][1]+":"+i.params[1][2]+i.params[1][3];return"Timeslot from "+r+" to "+a+" is "+t+" ("+n+")";case"weekday":var s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=i.params;return'Weekday "'+s[l]+'" is '+t+" ("+n+")";default:return i+" - "+t}}},{key:"getVariables",value:function(){var e=[];for(var i in this.variables)e.push(i);return e}},{key:"getVariableInfo",value:function(e){return this.variables[e]}},{key:"getMyEmails",value:function(){return this.policyEngine.context.getMyEmails()}},{key:"getMyHyperties",value:function(){return this.policyEngine.context.getMyHyperties()}},{key:"setInfo",value:function(e,i,t,n,o,r){if(!this.validation[e](o,t))throw Error("Invalid configuration");this.addition[e]([i,o,r,t,n])}},{key:"getInfo",value:function(e,i){var t=this.policies[e],n={};for(var o in t)t[o].condition===i&&(n=t[o]);if(n!=={}){var r=n.condition.split(" ");return this.policyEngine.getList(e,r[2])}throw Error("Policy <"+i+"> not found!")}},{key:"deleteInfo",value:function(e,i,t,n){var o=[i,t,n];if("member"===e){var r=n.split(" "),a=r[2];o=[i,a,n]}this.deletion[e](o)}},{key:"getGroup",value:function(e,i,t){return this.policyEngine.getGroup(e,i,t)}},{key:"getGroups",value:function(){var e=this.policyEngine.context.groups,i={groupsNames:[],members:[],ids:[]};for(var t in e){i.groupsNames.push(t),i.members.push(e[t]);var n=[];for(var o in e[t])n.push(t+"::"+e[t][o]);i.ids.push(n)}return i}},{key:"getGroupsNames",value:function(){return this.policyEngine.getGroupsNames()}},{key:"removeFromGroup",value:function(e,i){this.policyEngine.removeFromGroup(e,i)}},{key:"updatePolicy",value:function(e,i,t,n){var o=this.policyEngine.context.userPolicies;if(o[e].deleteRule(i),n){var r="*"===n?"equals":"in";o[e].createRule("subscription",t,["subscription",r,n],i.scope,i.target,i.priority)}else{var a=void 0;a="subscription"===i.condition.attribute?"subscription":"simple",o[e].createRule(a,t,i.condition,i.scope,i.target,i.priority)}this.policyEngine.context.savePolicies("USER")}}]),e}();t["default"]=r},{}]},{},[1])(1)});
//# sourceMappingURL=policies-gui.js.map
